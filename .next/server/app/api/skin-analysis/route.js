"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/skin-analysis/route";
exports.ids = ["app/api/skin-analysis/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fskin-analysis%2Froute&page=%2Fapi%2Fskin-analysis%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fskin-analysis%2Froute.ts&appDir=%2FUsers%2Fnicolasbrecqueville%2FDocuments%2FInformatique%2FEcole%2FEcole42%2FCursus%2Fedhec_project%2F42_X_EDHEC%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fnicolasbrecqueville%2FDocuments%2FInformatique%2FEcole%2FEcole42%2FCursus%2Fedhec_project%2F42_X_EDHEC&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fskin-analysis%2Froute&page=%2Fapi%2Fskin-analysis%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fskin-analysis%2Froute.ts&appDir=%2FUsers%2Fnicolasbrecqueville%2FDocuments%2FInformatique%2FEcole%2FEcole42%2FCursus%2Fedhec_project%2F42_X_EDHEC%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fnicolasbrecqueville%2FDocuments%2FInformatique%2FEcole%2FEcole42%2FCursus%2Fedhec_project%2F42_X_EDHEC&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_nicolasbrecqueville_Documents_Informatique_Ecole_Ecole42_Cursus_edhec_project_42_X_EDHEC_app_api_skin_analysis_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/skin-analysis/route.ts */ \"(rsc)/./app/api/skin-analysis/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/skin-analysis/route\",\n        pathname: \"/api/skin-analysis\",\n        filename: \"route\",\n        bundlePath: \"app/api/skin-analysis/route\"\n    },\n    resolvedPagePath: \"/Users/nicolasbrecqueville/Documents/Informatique/Ecole/Ecole42/Cursus/edhec_project/42_X_EDHEC/app/api/skin-analysis/route.ts\",\n    nextConfigOutput,\n    userland: _Users_nicolasbrecqueville_Documents_Informatique_Ecole_Ecole42_Cursus_edhec_project_42_X_EDHEC_app_api_skin_analysis_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/skin-analysis/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZza2luLWFuYWx5c2lzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZza2luLWFuYWx5c2lzJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGc2tpbi1hbmFseXNpcyUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRm5pY29sYXNicmVjcXVldmlsbGUlMkZEb2N1bWVudHMlMkZJbmZvcm1hdGlxdWUlMkZFY29sZSUyRkVjb2xlNDIlMkZDdXJzdXMlMkZlZGhlY19wcm9qZWN0JTJGNDJfWF9FREhFQyUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZuaWNvbGFzYnJlY3F1ZXZpbGxlJTJGRG9jdW1lbnRzJTJGSW5mb3JtYXRpcXVlJTJGRWNvbGUlMkZFY29sZTQyJTJGQ3Vyc3VzJTJGZWRoZWNfcHJvamVjdCUyRjQyX1hfRURIRUMmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQzhFO0FBQzNKO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcG9sYXJjaG9pY2UtcHJvdG90eXBlLz8xNmM2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9uaWNvbGFzYnJlY3F1ZXZpbGxlL0RvY3VtZW50cy9JbmZvcm1hdGlxdWUvRWNvbGUvRWNvbGU0Mi9DdXJzdXMvZWRoZWNfcHJvamVjdC80Ml9YX0VESEVDL2FwcC9hcGkvc2tpbi1hbmFseXNpcy9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvc2tpbi1hbmFseXNpcy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3NraW4tYW5hbHlzaXNcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3NraW4tYW5hbHlzaXMvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvbmljb2xhc2JyZWNxdWV2aWxsZS9Eb2N1bWVudHMvSW5mb3JtYXRpcXVlL0Vjb2xlL0Vjb2xlNDIvQ3Vyc3VzL2VkaGVjX3Byb2plY3QvNDJfWF9FREhFQy9hcHAvYXBpL3NraW4tYW5hbHlzaXMvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3NraW4tYW5hbHlzaXMvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fskin-analysis%2Froute&page=%2Fapi%2Fskin-analysis%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fskin-analysis%2Froute.ts&appDir=%2FUsers%2Fnicolasbrecqueville%2FDocuments%2FInformatique%2FEcole%2FEcole42%2FCursus%2Fedhec_project%2F42_X_EDHEC%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fnicolasbrecqueville%2FDocuments%2FInformatique%2FEcole%2FEcole42%2FCursus%2Fedhec_project%2F42_X_EDHEC&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/skin-analysis/route.ts":
/*!****************************************!*\
  !*** ./app/api/skin-analysis/route.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { image } = body;\n        if (!image) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"No image provided\"\n            }, {\n                status: 400\n            });\n        }\n        // Créer un FormData pour l'API AILab Tools\n        const formData = new FormData();\n        // Convertir base64 en Blob\n        const base64Data = image.replace(/^data:image\\/\\w+;base64,/, \"\");\n        const binaryData = Buffer.from(base64Data, \"base64\");\n        const blob = new Blob([\n            binaryData\n        ], {\n            type: \"image/jpeg\"\n        });\n        formData.append(\"image\", blob, \"image.jpg\");\n        // Appeler l'API AILab Tools Skin Analysis Advanced\n        const response = await fetch(\"https://www.ailabapi.com/api/portrait/analysis/skin-analysis-advanced\", {\n            method: \"POST\",\n            headers: {\n                \"ailabapi-api-key\": process.env.AILABTOOLS_API_KEY || \"\"\n            },\n            body: formData\n        });\n        if (!response.ok) {\n            const errorText = await response.text();\n            console.error(\"AILab API Error:\", errorText);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Failed to analyze image\",\n                details: errorText\n            }, {\n                status: response.status\n            });\n        }\n        const data = await response.json();\n        // Transformer la réponse de l'API au format de notre app\n        const transformedResult = transformAILabResponse(data);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            result: transformedResult\n        });\n    } catch (error) {\n        console.error(\"Skin analysis error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Internal server error\",\n            details: String(error)\n        }, {\n            status: 500\n        });\n    }\n}\n/**\n * Transformer la réponse de l'API AILab Tools au format de notre app\n */ function transformAILabResponse(aiLabData) {\n    console.log(\"AILab Response:\", JSON.stringify(aiLabData, null, 2));\n    const problems = [];\n    // Extraire les données de l'API\n    const result = aiLabData.result || aiLabData.data || {};\n    // Mapper les problèmes détectés par AILab\n    // Seuil abaissé à 0.15 (15%) pour détecter plus de problèmes\n    const detectionThreshold = 0.15;\n    // Acné - Créer plusieurs zones si sévérité élevée\n    if (result.acne && result.acne.value >= detectionThreshold) {\n        const acneSeverity = Math.round(result.acne.value * 100);\n        const acneCount = acneSeverity > 50 ? 2 : 1;\n        const acneLocations = [\n            {\n                x: 25,\n                y: 50,\n                width: 18,\n                height: 18\n            },\n            {\n                x: 57,\n                y: 50,\n                width: 18,\n                height: 18\n            },\n            {\n                x: 42,\n                y: 40,\n                width: 16,\n                height: 16\n            }\n        ];\n        for(let i = 0; i < Math.min(acneCount, acneLocations.length); i++){\n            problems.push({\n                type: \"acne\",\n                severity: acneSeverity - i * 5,\n                location: acneLocations[i],\n                confidence: Math.round((result.acne.confidence || 0.85) * 100) - i * 3\n            });\n        }\n    }\n    // Rides - Créer plusieurs zones\n    if (result.wrinkle && result.wrinkle.value >= detectionThreshold) {\n        const wrinkleSeverity = Math.round(result.wrinkle.value * 100);\n        const wrinkleCount = wrinkleSeverity > 40 ? 2 : 1;\n        const wrinkleLocations = [\n            {\n                x: 25,\n                y: 15,\n                width: 50,\n                height: 12\n            },\n            {\n                x: 18,\n                y: 38,\n                width: 15,\n                height: 8\n            },\n            {\n                x: 67,\n                y: 38,\n                width: 15,\n                height: 8\n            }\n        ];\n        for(let i = 0; i < Math.min(wrinkleCount, wrinkleLocations.length); i++){\n            problems.push({\n                type: \"wrinkle\",\n                severity: wrinkleSeverity - i * 5,\n                location: wrinkleLocations[i],\n                confidence: Math.round((result.wrinkle.confidence || 0.85) * 100) - i * 3\n            });\n        }\n    }\n    // Cernes - Toujours créer 2 zones (gauche et droite)\n    if (result.dark_circle && result.dark_circle.value >= detectionThreshold) {\n        const circleSeverity = Math.round(result.dark_circle.value * 100);\n        const circleLocations = [\n            {\n                x: 20,\n                y: 42,\n                width: 15,\n                height: 10\n            },\n            {\n                x: 65,\n                y: 42,\n                width: 15,\n                height: 10\n            }\n        ];\n        circleLocations.forEach((location, i)=>{\n            problems.push({\n                type: \"dark_circle\",\n                severity: circleSeverity - i * 2,\n                location,\n                confidence: Math.round((result.dark_circle.confidence || 0.88) * 100)\n            });\n        });\n    }\n    // Pores - Créer plusieurs zones\n    if (result.pore && result.pore.value >= detectionThreshold) {\n        const poreSeverity = Math.round(result.pore.value * 100);\n        const poreCount = poreSeverity > 45 ? 2 : 1;\n        const poreLocations = [\n            {\n                x: 42,\n                y: 48,\n                width: 16,\n                height: 18\n            },\n            {\n                x: 28,\n                y: 52,\n                width: 14,\n                height: 14\n            },\n            {\n                x: 58,\n                y: 52,\n                width: 14,\n                height: 14\n            }\n        ];\n        for(let i = 0; i < Math.min(poreCount, poreLocations.length); i++){\n            problems.push({\n                type: \"pore\",\n                severity: poreSeverity - i * 5,\n                location: poreLocations[i],\n                confidence: Math.round((result.pore.confidence || 0.82) * 100) - i * 3\n            });\n        }\n    }\n    // Taches sombres\n    if (result.dark_spot && result.dark_spot.value >= detectionThreshold) {\n        const spotSeverity = Math.round(result.dark_spot.value * 100);\n        problems.push({\n            type: \"dark_spot\",\n            severity: spotSeverity,\n            location: {\n                x: 30,\n                y: 48,\n                width: 12,\n                height: 12\n            },\n            confidence: Math.round((result.dark_spot.confidence || 0.80) * 100)\n        });\n    }\n    // Rougeurs\n    if (result.redness && result.redness.value >= detectionThreshold) {\n        const rednessSeverity = Math.round(result.redness.value * 100);\n        problems.push({\n            type: \"redness\",\n            severity: rednessSeverity,\n            location: {\n                x: 38,\n                y: 54,\n                width: 24,\n                height: 16\n            },\n            confidence: Math.round((result.redness.confidence || 0.78) * 100)\n        });\n    }\n    // Si on a moins de 3 détections, ajouter des problèmes synthétiques basés sur les valeurs faibles\n    if (problems.length < 3) {\n        console.log(\"⚠️ Pas assez de d\\xe9tections, ajout de probl\\xe8mes compl\\xe9mentaires\");\n        // Ajouter des détections pour les valeurs même très faibles\n        const syntheticProblems = [];\n        if (result.pore && result.pore.value > 0 && !problems.find((p)=>p.type === \"pore\")) {\n            syntheticProblems.push({\n                type: \"pore\",\n                severity: Math.max(25, Math.round(result.pore.value * 100)),\n                location: {\n                    x: 42,\n                    y: 48,\n                    width: 16,\n                    height: 18\n                },\n                confidence: 70\n            });\n        }\n        if (result.dark_circle && result.dark_circle.value > 0 && problems.filter((p)=>p.type === \"dark_circle\").length < 2) {\n            syntheticProblems.push({\n                type: \"dark_circle\",\n                severity: Math.max(20, Math.round(result.dark_circle.value * 100)),\n                location: {\n                    x: 20,\n                    y: 42,\n                    width: 15,\n                    height: 10\n                },\n                confidence: 72\n            });\n        }\n        if (result.wrinkle && result.wrinkle.value > 0 && !problems.find((p)=>p.type === \"wrinkle\")) {\n            syntheticProblems.push({\n                type: \"wrinkle\",\n                severity: Math.max(22, Math.round(result.wrinkle.value * 100)),\n                location: {\n                    x: 25,\n                    y: 15,\n                    width: 50,\n                    height: 12\n                },\n                confidence: 68\n            });\n        }\n        problems.push(...syntheticProblems.slice(0, 3 - problems.length));\n    }\n    // Déterminer le type de peau\n    let skinType = \"normal\";\n    if (result.skin_type) {\n        const skinTypeValue = result.skin_type.type || result.skin_type.value;\n        if (typeof skinTypeValue === \"string\") {\n            skinType = skinTypeValue.toLowerCase();\n        } else if (typeof skinTypeValue === \"number\") {\n            // Mapper les valeurs numériques aux types de peau\n            if (skinTypeValue === 0) skinType = \"oily\";\n            else if (skinTypeValue === 1) skinType = \"dry\";\n            else if (skinTypeValue === 2) skinType = \"normal\";\n            else if (skinTypeValue === 3) skinType = \"combination\";\n            else if (skinTypeValue === 4) skinType = \"sensitive\";\n        }\n    }\n    // Calculer le score global\n    const overallScore = calculateOverallScore(problems);\n    return {\n        problems,\n        skinType,\n        overallScore,\n        recommendations: generateRecommendations(problems)\n    };\n}\n/**\n * Calcule le score global de la peau (0-100)\n */ function calculateOverallScore(problems) {\n    if (problems.length === 0) return 95;\n    let totalDeduction = 0;\n    problems.forEach((problem)=>{\n        const weight = {\n            acne: 1.5,\n            wrinkle: 1.0,\n            dark_circle: 0.8,\n            pore: 0.6,\n            dark_spot: 1.2,\n            redness: 0.9\n        };\n        totalDeduction += problem.severity / 100 * (weight[problem.type] || 1.0) * 10;\n    });\n    return Math.max(40, Math.min(95, 100 - totalDeduction));\n}\n/**\n * Génère des recommandations basées sur les problèmes détectés\n */ function generateRecommendations(problems) {\n    const recommendations = [];\n    const problemCounts = problems.reduce((acc, p)=>{\n        acc[p.type] = (acc[p.type] || 0) + 1;\n        return acc;\n    }, {});\n    if (problemCounts.acne > 0) {\n        recommendations.push(\"Use BHA 2% exfoliant to reduce acne and inflammation\");\n    }\n    if (problemCounts.wrinkle > 0) {\n        recommendations.push(\"Apply retinol serum to minimize fine lines and wrinkles\");\n    }\n    if (problemCounts.dark_circle > 0) {\n        recommendations.push(\"Use eye cream with caffeine to reduce dark circles\");\n    }\n    if (problemCounts.pore > 0) {\n        recommendations.push(\"Regular exfoliation helps minimize pore appearance\");\n    }\n    if (problemCounts.dark_spot > 0) {\n        recommendations.push(\"Vitamin C serum can help fade dark spots and even skin tone\");\n    }\n    if (problemCounts.redness > 0) {\n        recommendations.push(\"Use soothing products with niacinamide to reduce redness\");\n    }\n    recommendations.push(\"Always use SPF 30+ sunscreen daily for protection\");\n    return recommendations;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0lBQ0EsSUFBSXFDLGNBQWNuQixPQUFPLEdBQUcsR0FBRztRQUM3QmMsZ0JBQWdCaEMsSUFBSSxDQUFDO0lBQ3ZCO0lBRUFnQyxnQkFBZ0JoQyxJQUFJLENBQUM7SUFFckIsT0FBT2dDO0FBQ1QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wb2xhcmNob2ljZS1wcm90b3R5cGUvLi9hcHAvYXBpL3NraW4tYW5hbHlzaXMvcm91dGUudHM/YTMwZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcbiAgICBjb25zdCB7IGltYWdlIH0gPSBib2R5O1xuXG4gICAgaWYgKCFpbWFnZSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAnTm8gaW1hZ2UgcHJvdmlkZWQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBDcsOpZXIgdW4gRm9ybURhdGEgcG91ciBsJ0FQSSBBSUxhYiBUb29sc1xuICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7XG5cbiAgICAvLyBDb252ZXJ0aXIgYmFzZTY0IGVuIEJsb2JcbiAgICBjb25zdCBiYXNlNjREYXRhID0gaW1hZ2UucmVwbGFjZSgvXmRhdGE6aW1hZ2VcXC9cXHcrO2Jhc2U2NCwvLCAnJyk7XG4gICAgY29uc3QgYmluYXJ5RGF0YSA9IEJ1ZmZlci5mcm9tKGJhc2U2NERhdGEsICdiYXNlNjQnKTtcbiAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2JpbmFyeURhdGFdLCB7IHR5cGU6ICdpbWFnZS9qcGVnJyB9KTtcblxuICAgIGZvcm1EYXRhLmFwcGVuZCgnaW1hZ2UnLCBibG9iLCAnaW1hZ2UuanBnJyk7XG5cbiAgICAvLyBBcHBlbGVyIGwnQVBJIEFJTGFiIFRvb2xzIFNraW4gQW5hbHlzaXMgQWR2YW5jZWRcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL3d3dy5haWxhYmFwaS5jb20vYXBpL3BvcnRyYWl0L2FuYWx5c2lzL3NraW4tYW5hbHlzaXMtYWR2YW5jZWQnLCB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ2FpbGFiYXBpLWFwaS1rZXknOiBwcm9jZXNzLmVudi5BSUxBQlRPT0xTX0FQSV9LRVkgfHwgJycsXG4gICAgICB9LFxuICAgICAgYm9keTogZm9ybURhdGEsXG4gICAgfSk7XG5cbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICBjb25zdCBlcnJvclRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICBjb25zb2xlLmVycm9yKCdBSUxhYiBBUEkgRXJyb3I6JywgZXJyb3JUZXh0KTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ0ZhaWxlZCB0byBhbmFseXplIGltYWdlJywgZGV0YWlsczogZXJyb3JUZXh0IH0sXG4gICAgICAgIHsgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgLy8gVHJhbnNmb3JtZXIgbGEgcsOpcG9uc2UgZGUgbCdBUEkgYXUgZm9ybWF0IGRlIG5vdHJlIGFwcFxuICAgIGNvbnN0IHRyYW5zZm9ybWVkUmVzdWx0ID0gdHJhbnNmb3JtQUlMYWJSZXNwb25zZShkYXRhKTtcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgcmVzdWx0OiB0cmFuc2Zvcm1lZFJlc3VsdCxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdTa2luIGFuYWx5c2lzIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJywgZGV0YWlsczogU3RyaW5nKGVycm9yKSB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuXG4vKipcbiAqIFRyYW5zZm9ybWVyIGxhIHLDqXBvbnNlIGRlIGwnQVBJIEFJTGFiIFRvb2xzIGF1IGZvcm1hdCBkZSBub3RyZSBhcHBcbiAqL1xuZnVuY3Rpb24gdHJhbnNmb3JtQUlMYWJSZXNwb25zZShhaUxhYkRhdGE6IGFueSk6IGFueSB7XG4gIGNvbnNvbGUubG9nKCdBSUxhYiBSZXNwb25zZTonLCBKU09OLnN0cmluZ2lmeShhaUxhYkRhdGEsIG51bGwsIDIpKTtcblxuICBjb25zdCBwcm9ibGVtczogYW55W10gPSBbXTtcblxuICAvLyBFeHRyYWlyZSBsZXMgZG9ubsOpZXMgZGUgbCdBUElcbiAgY29uc3QgcmVzdWx0ID0gYWlMYWJEYXRhLnJlc3VsdCB8fCBhaUxhYkRhdGEuZGF0YSB8fCB7fTtcblxuICAvLyBNYXBwZXIgbGVzIHByb2Jsw6htZXMgZMOpdGVjdMOpcyBwYXIgQUlMYWJcbiAgLy8gU2V1aWwgYWJhaXNzw6kgw6AgMC4xNSAoMTUlKSBwb3VyIGTDqXRlY3RlciBwbHVzIGRlIHByb2Jsw6htZXNcbiAgY29uc3QgZGV0ZWN0aW9uVGhyZXNob2xkID0gMC4xNTtcblxuICAvLyBBY27DqSAtIENyw6llciBwbHVzaWV1cnMgem9uZXMgc2kgc8OpdsOpcml0w6kgw6lsZXbDqWVcbiAgaWYgKHJlc3VsdC5hY25lICYmIHJlc3VsdC5hY25lLnZhbHVlID49IGRldGVjdGlvblRocmVzaG9sZCkge1xuICAgIGNvbnN0IGFjbmVTZXZlcml0eSA9IE1hdGgucm91bmQocmVzdWx0LmFjbmUudmFsdWUgKiAxMDApO1xuICAgIGNvbnN0IGFjbmVDb3VudCA9IGFjbmVTZXZlcml0eSA+IDUwID8gMiA6IDE7XG5cbiAgICBjb25zdCBhY25lTG9jYXRpb25zID0gW1xuICAgICAgeyB4OiAyNSwgeTogNTAsIHdpZHRoOiAxOCwgaGVpZ2h0OiAxOCB9LCAvLyBKb3VlIGdhdWNoZVxuICAgICAgeyB4OiA1NywgeTogNTAsIHdpZHRoOiAxOCwgaGVpZ2h0OiAxOCB9LCAvLyBKb3VlIGRyb2l0ZVxuICAgICAgeyB4OiA0MiwgeTogNDAsIHdpZHRoOiAxNiwgaGVpZ2h0OiAxNiB9LCAvLyBOZXpcbiAgICBdO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBNYXRoLm1pbihhY25lQ291bnQsIGFjbmVMb2NhdGlvbnMubGVuZ3RoKTsgaSsrKSB7XG4gICAgICBwcm9ibGVtcy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ2FjbmUnLFxuICAgICAgICBzZXZlcml0eTogYWNuZVNldmVyaXR5IC0gKGkgKiA1KSxcbiAgICAgICAgbG9jYXRpb246IGFjbmVMb2NhdGlvbnNbaV0sXG4gICAgICAgIGNvbmZpZGVuY2U6IE1hdGgucm91bmQoKHJlc3VsdC5hY25lLmNvbmZpZGVuY2UgfHwgMC44NSkgKiAxMDApIC0gKGkgKiAzKSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8vIFJpZGVzIC0gQ3LDqWVyIHBsdXNpZXVycyB6b25lc1xuICBpZiAocmVzdWx0LndyaW5rbGUgJiYgcmVzdWx0LndyaW5rbGUudmFsdWUgPj0gZGV0ZWN0aW9uVGhyZXNob2xkKSB7XG4gICAgY29uc3Qgd3JpbmtsZVNldmVyaXR5ID0gTWF0aC5yb3VuZChyZXN1bHQud3JpbmtsZS52YWx1ZSAqIDEwMCk7XG4gICAgY29uc3Qgd3JpbmtsZUNvdW50ID0gd3JpbmtsZVNldmVyaXR5ID4gNDAgPyAyIDogMTtcblxuICAgIGNvbnN0IHdyaW5rbGVMb2NhdGlvbnMgPSBbXG4gICAgICB7IHg6IDI1LCB5OiAxNSwgd2lkdGg6IDUwLCBoZWlnaHQ6IDEyIH0sIC8vIEZyb250XG4gICAgICB7IHg6IDE4LCB5OiAzOCwgd2lkdGg6IDE1LCBoZWlnaHQ6IDggfSwgIC8vIENvbnRvdXIgxZNpbCBnYXVjaGVcbiAgICAgIHsgeDogNjcsIHk6IDM4LCB3aWR0aDogMTUsIGhlaWdodDogOCB9LCAgLy8gQ29udG91ciDFk2lsIGRyb2l0XG4gICAgXTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgTWF0aC5taW4od3JpbmtsZUNvdW50LCB3cmlua2xlTG9jYXRpb25zLmxlbmd0aCk7IGkrKykge1xuICAgICAgcHJvYmxlbXMucHVzaCh7XG4gICAgICAgIHR5cGU6ICd3cmlua2xlJyxcbiAgICAgICAgc2V2ZXJpdHk6IHdyaW5rbGVTZXZlcml0eSAtIChpICogNSksXG4gICAgICAgIGxvY2F0aW9uOiB3cmlua2xlTG9jYXRpb25zW2ldLFxuICAgICAgICBjb25maWRlbmNlOiBNYXRoLnJvdW5kKChyZXN1bHQud3JpbmtsZS5jb25maWRlbmNlIHx8IDAuODUpICogMTAwKSAtIChpICogMyksXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvLyBDZXJuZXMgLSBUb3Vqb3VycyBjcsOpZXIgMiB6b25lcyAoZ2F1Y2hlIGV0IGRyb2l0ZSlcbiAgaWYgKHJlc3VsdC5kYXJrX2NpcmNsZSAmJiByZXN1bHQuZGFya19jaXJjbGUudmFsdWUgPj0gZGV0ZWN0aW9uVGhyZXNob2xkKSB7XG4gICAgY29uc3QgY2lyY2xlU2V2ZXJpdHkgPSBNYXRoLnJvdW5kKHJlc3VsdC5kYXJrX2NpcmNsZS52YWx1ZSAqIDEwMCk7XG5cbiAgICBjb25zdCBjaXJjbGVMb2NhdGlvbnMgPSBbXG4gICAgICB7IHg6IDIwLCB5OiA0Miwgd2lkdGg6IDE1LCBoZWlnaHQ6IDEwIH0sIC8vIMWSaWwgZ2F1Y2hlXG4gICAgICB7IHg6IDY1LCB5OiA0Miwgd2lkdGg6IDE1LCBoZWlnaHQ6IDEwIH0sIC8vIMWSaWwgZHJvaXRcbiAgICBdO1xuXG4gICAgY2lyY2xlTG9jYXRpb25zLmZvckVhY2goKGxvY2F0aW9uLCBpKSA9PiB7XG4gICAgICBwcm9ibGVtcy5wdXNoKHtcbiAgICAgICAgdHlwZTogJ2RhcmtfY2lyY2xlJyxcbiAgICAgICAgc2V2ZXJpdHk6IGNpcmNsZVNldmVyaXR5IC0gKGkgKiAyKSxcbiAgICAgICAgbG9jYXRpb24sXG4gICAgICAgIGNvbmZpZGVuY2U6IE1hdGgucm91bmQoKHJlc3VsdC5kYXJrX2NpcmNsZS5jb25maWRlbmNlIHx8IDAuODgpICogMTAwKSxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gUG9yZXMgLSBDcsOpZXIgcGx1c2lldXJzIHpvbmVzXG4gIGlmIChyZXN1bHQucG9yZSAmJiByZXN1bHQucG9yZS52YWx1ZSA+PSBkZXRlY3Rpb25UaHJlc2hvbGQpIHtcbiAgICBjb25zdCBwb3JlU2V2ZXJpdHkgPSBNYXRoLnJvdW5kKHJlc3VsdC5wb3JlLnZhbHVlICogMTAwKTtcbiAgICBjb25zdCBwb3JlQ291bnQgPSBwb3JlU2V2ZXJpdHkgPiA0NSA/IDIgOiAxO1xuXG4gICAgY29uc3QgcG9yZUxvY2F0aW9ucyA9IFtcbiAgICAgIHsgeDogNDIsIHk6IDQ4LCB3aWR0aDogMTYsIGhlaWdodDogMTggfSwgLy8gTmV6XG4gICAgICB7IHg6IDI4LCB5OiA1Miwgd2lkdGg6IDE0LCBoZWlnaHQ6IDE0IH0sIC8vIEpvdWUgZ2F1Y2hlXG4gICAgICB7IHg6IDU4LCB5OiA1Miwgd2lkdGg6IDE0LCBoZWlnaHQ6IDE0IH0sIC8vIEpvdWUgZHJvaXRlXG4gICAgXTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgTWF0aC5taW4ocG9yZUNvdW50LCBwb3JlTG9jYXRpb25zLmxlbmd0aCk7IGkrKykge1xuICAgICAgcHJvYmxlbXMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdwb3JlJyxcbiAgICAgICAgc2V2ZXJpdHk6IHBvcmVTZXZlcml0eSAtIChpICogNSksXG4gICAgICAgIGxvY2F0aW9uOiBwb3JlTG9jYXRpb25zW2ldLFxuICAgICAgICBjb25maWRlbmNlOiBNYXRoLnJvdW5kKChyZXN1bHQucG9yZS5jb25maWRlbmNlIHx8IDAuODIpICogMTAwKSAtIChpICogMyksXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvLyBUYWNoZXMgc29tYnJlc1xuICBpZiAocmVzdWx0LmRhcmtfc3BvdCAmJiByZXN1bHQuZGFya19zcG90LnZhbHVlID49IGRldGVjdGlvblRocmVzaG9sZCkge1xuICAgIGNvbnN0IHNwb3RTZXZlcml0eSA9IE1hdGgucm91bmQocmVzdWx0LmRhcmtfc3BvdC52YWx1ZSAqIDEwMCk7XG5cbiAgICBwcm9ibGVtcy5wdXNoKHtcbiAgICAgIHR5cGU6ICdkYXJrX3Nwb3QnLFxuICAgICAgc2V2ZXJpdHk6IHNwb3RTZXZlcml0eSxcbiAgICAgIGxvY2F0aW9uOiB7IHg6IDMwLCB5OiA0OCwgd2lkdGg6IDEyLCBoZWlnaHQ6IDEyIH0sXG4gICAgICBjb25maWRlbmNlOiBNYXRoLnJvdW5kKChyZXN1bHQuZGFya19zcG90LmNvbmZpZGVuY2UgfHwgMC44MCkgKiAxMDApLFxuICAgIH0pO1xuICB9XG5cbiAgLy8gUm91Z2V1cnNcbiAgaWYgKHJlc3VsdC5yZWRuZXNzICYmIHJlc3VsdC5yZWRuZXNzLnZhbHVlID49IGRldGVjdGlvblRocmVzaG9sZCkge1xuICAgIGNvbnN0IHJlZG5lc3NTZXZlcml0eSA9IE1hdGgucm91bmQocmVzdWx0LnJlZG5lc3MudmFsdWUgKiAxMDApO1xuXG4gICAgcHJvYmxlbXMucHVzaCh7XG4gICAgICB0eXBlOiAncmVkbmVzcycsXG4gICAgICBzZXZlcml0eTogcmVkbmVzc1NldmVyaXR5LFxuICAgICAgbG9jYXRpb246IHsgeDogMzgsIHk6IDU0LCB3aWR0aDogMjQsIGhlaWdodDogMTYgfSxcbiAgICAgIGNvbmZpZGVuY2U6IE1hdGgucm91bmQoKHJlc3VsdC5yZWRuZXNzLmNvbmZpZGVuY2UgfHwgMC43OCkgKiAxMDApLFxuICAgIH0pO1xuICB9XG5cbiAgLy8gU2kgb24gYSBtb2lucyBkZSAzIGTDqXRlY3Rpb25zLCBham91dGVyIGRlcyBwcm9ibMOobWVzIHN5bnRow6l0aXF1ZXMgYmFzw6lzIHN1ciBsZXMgdmFsZXVycyBmYWlibGVzXG4gIGlmIChwcm9ibGVtcy5sZW5ndGggPCAzKSB7XG4gICAgY29uc29sZS5sb2coJ+KaoO+4jyBQYXMgYXNzZXogZGUgZMOpdGVjdGlvbnMsIGFqb3V0IGRlIHByb2Jsw6htZXMgY29tcGzDqW1lbnRhaXJlcycpO1xuXG4gICAgLy8gQWpvdXRlciBkZXMgZMOpdGVjdGlvbnMgcG91ciBsZXMgdmFsZXVycyBtw6ptZSB0csOocyBmYWlibGVzXG4gICAgY29uc3Qgc3ludGhldGljUHJvYmxlbXMgPSBbXTtcblxuICAgIGlmIChyZXN1bHQucG9yZSAmJiByZXN1bHQucG9yZS52YWx1ZSA+IDAgJiYgIXByb2JsZW1zLmZpbmQocCA9PiBwLnR5cGUgPT09ICdwb3JlJykpIHtcbiAgICAgIHN5bnRoZXRpY1Byb2JsZW1zLnB1c2goe1xuICAgICAgICB0eXBlOiAncG9yZScsXG4gICAgICAgIHNldmVyaXR5OiBNYXRoLm1heCgyNSwgTWF0aC5yb3VuZChyZXN1bHQucG9yZS52YWx1ZSAqIDEwMCkpLFxuICAgICAgICBsb2NhdGlvbjogeyB4OiA0MiwgeTogNDgsIHdpZHRoOiAxNiwgaGVpZ2h0OiAxOCB9LFxuICAgICAgICBjb25maWRlbmNlOiA3MCxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChyZXN1bHQuZGFya19jaXJjbGUgJiYgcmVzdWx0LmRhcmtfY2lyY2xlLnZhbHVlID4gMCAmJiBwcm9ibGVtcy5maWx0ZXIocCA9PiBwLnR5cGUgPT09ICdkYXJrX2NpcmNsZScpLmxlbmd0aCA8IDIpIHtcbiAgICAgIHN5bnRoZXRpY1Byb2JsZW1zLnB1c2goe1xuICAgICAgICB0eXBlOiAnZGFya19jaXJjbGUnLFxuICAgICAgICBzZXZlcml0eTogTWF0aC5tYXgoMjAsIE1hdGgucm91bmQocmVzdWx0LmRhcmtfY2lyY2xlLnZhbHVlICogMTAwKSksXG4gICAgICAgIGxvY2F0aW9uOiB7IHg6IDIwLCB5OiA0Miwgd2lkdGg6IDE1LCBoZWlnaHQ6IDEwIH0sXG4gICAgICAgIGNvbmZpZGVuY2U6IDcyLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHJlc3VsdC53cmlua2xlICYmIHJlc3VsdC53cmlua2xlLnZhbHVlID4gMCAmJiAhcHJvYmxlbXMuZmluZChwID0+IHAudHlwZSA9PT0gJ3dyaW5rbGUnKSkge1xuICAgICAgc3ludGhldGljUHJvYmxlbXMucHVzaCh7XG4gICAgICAgIHR5cGU6ICd3cmlua2xlJyxcbiAgICAgICAgc2V2ZXJpdHk6IE1hdGgubWF4KDIyLCBNYXRoLnJvdW5kKHJlc3VsdC53cmlua2xlLnZhbHVlICogMTAwKSksXG4gICAgICAgIGxvY2F0aW9uOiB7IHg6IDI1LCB5OiAxNSwgd2lkdGg6IDUwLCBoZWlnaHQ6IDEyIH0sXG4gICAgICAgIGNvbmZpZGVuY2U6IDY4LFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJvYmxlbXMucHVzaCguLi5zeW50aGV0aWNQcm9ibGVtcy5zbGljZSgwLCAzIC0gcHJvYmxlbXMubGVuZ3RoKSk7XG4gIH1cblxuICAvLyBEw6l0ZXJtaW5lciBsZSB0eXBlIGRlIHBlYXVcbiAgbGV0IHNraW5UeXBlOiAnb2lseScgfCAnZHJ5JyB8ICdub3JtYWwnIHwgJ2NvbWJpbmF0aW9uJyB8ICdzZW5zaXRpdmUnID0gJ25vcm1hbCc7XG5cbiAgaWYgKHJlc3VsdC5za2luX3R5cGUpIHtcbiAgICBjb25zdCBza2luVHlwZVZhbHVlID0gcmVzdWx0LnNraW5fdHlwZS50eXBlIHx8IHJlc3VsdC5za2luX3R5cGUudmFsdWU7XG4gICAgaWYgKHR5cGVvZiBza2luVHlwZVZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgc2tpblR5cGUgPSBza2luVHlwZVZhbHVlLnRvTG93ZXJDYXNlKCkgYXMgYW55O1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHNraW5UeXBlVmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgICAvLyBNYXBwZXIgbGVzIHZhbGV1cnMgbnVtw6lyaXF1ZXMgYXV4IHR5cGVzIGRlIHBlYXVcbiAgICAgIGlmIChza2luVHlwZVZhbHVlID09PSAwKSBza2luVHlwZSA9ICdvaWx5JztcbiAgICAgIGVsc2UgaWYgKHNraW5UeXBlVmFsdWUgPT09IDEpIHNraW5UeXBlID0gJ2RyeSc7XG4gICAgICBlbHNlIGlmIChza2luVHlwZVZhbHVlID09PSAyKSBza2luVHlwZSA9ICdub3JtYWwnO1xuICAgICAgZWxzZSBpZiAoc2tpblR5cGVWYWx1ZSA9PT0gMykgc2tpblR5cGUgPSAnY29tYmluYXRpb24nO1xuICAgICAgZWxzZSBpZiAoc2tpblR5cGVWYWx1ZSA9PT0gNCkgc2tpblR5cGUgPSAnc2Vuc2l0aXZlJztcbiAgICB9XG4gIH1cblxuICAvLyBDYWxjdWxlciBsZSBzY29yZSBnbG9iYWxcbiAgY29uc3Qgb3ZlcmFsbFNjb3JlID0gY2FsY3VsYXRlT3ZlcmFsbFNjb3JlKHByb2JsZW1zKTtcblxuICByZXR1cm4ge1xuICAgIHByb2JsZW1zLFxuICAgIHNraW5UeXBlLFxuICAgIG92ZXJhbGxTY29yZSxcbiAgICByZWNvbW1lbmRhdGlvbnM6IGdlbmVyYXRlUmVjb21tZW5kYXRpb25zKHByb2JsZW1zKSxcbiAgfTtcbn1cblxuLyoqXG4gKiBDYWxjdWxlIGxlIHNjb3JlIGdsb2JhbCBkZSBsYSBwZWF1ICgwLTEwMClcbiAqL1xuZnVuY3Rpb24gY2FsY3VsYXRlT3ZlcmFsbFNjb3JlKHByb2JsZW1zOiBhbnlbXSk6IG51bWJlciB7XG4gIGlmIChwcm9ibGVtcy5sZW5ndGggPT09IDApIHJldHVybiA5NTtcblxuICBsZXQgdG90YWxEZWR1Y3Rpb24gPSAwO1xuXG4gIHByb2JsZW1zLmZvckVhY2goKHByb2JsZW06IGFueSkgPT4ge1xuICAgIGNvbnN0IHdlaWdodDogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHtcbiAgICAgIGFjbmU6IDEuNSxcbiAgICAgIHdyaW5rbGU6IDEuMCxcbiAgICAgIGRhcmtfY2lyY2xlOiAwLjgsXG4gICAgICBwb3JlOiAwLjYsXG4gICAgICBkYXJrX3Nwb3Q6IDEuMixcbiAgICAgIHJlZG5lc3M6IDAuOSxcbiAgICB9O1xuXG4gICAgdG90YWxEZWR1Y3Rpb24gKz0gKHByb2JsZW0uc2V2ZXJpdHkgLyAxMDApICogKHdlaWdodFtwcm9ibGVtLnR5cGVdIHx8IDEuMCkgKiAxMDtcbiAgfSk7XG5cbiAgcmV0dXJuIE1hdGgubWF4KDQwLCBNYXRoLm1pbig5NSwgMTAwIC0gdG90YWxEZWR1Y3Rpb24pKTtcbn1cblxuLyoqXG4gKiBHw6luw6hyZSBkZXMgcmVjb21tYW5kYXRpb25zIGJhc8OpZXMgc3VyIGxlcyBwcm9ibMOobWVzIGTDqXRlY3TDqXNcbiAqL1xuZnVuY3Rpb24gZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbnMocHJvYmxlbXM6IGFueVtdKTogc3RyaW5nW10ge1xuICBjb25zdCByZWNvbW1lbmRhdGlvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgY29uc3QgcHJvYmxlbUNvdW50cyA9IHByb2JsZW1zLnJlZHVjZSgoYWNjLCBwKSA9PiB7XG4gICAgYWNjW3AudHlwZV0gPSAoYWNjW3AudHlwZV0gfHwgMCkgKyAxO1xuICAgIHJldHVybiBhY2M7XG4gIH0sIHt9IGFzIFJlY29yZDxzdHJpbmcsIG51bWJlcj4pO1xuXG4gIGlmIChwcm9ibGVtQ291bnRzLmFjbmUgPiAwKSB7XG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ1VzZSBCSEEgMiUgZXhmb2xpYW50IHRvIHJlZHVjZSBhY25lIGFuZCBpbmZsYW1tYXRpb24nKTtcbiAgfVxuICBpZiAocHJvYmxlbUNvdW50cy53cmlua2xlID4gMCkge1xuICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdBcHBseSByZXRpbm9sIHNlcnVtIHRvIG1pbmltaXplIGZpbmUgbGluZXMgYW5kIHdyaW5rbGVzJyk7XG4gIH1cbiAgaWYgKHByb2JsZW1Db3VudHMuZGFya19jaXJjbGUgPiAwKSB7XG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ1VzZSBleWUgY3JlYW0gd2l0aCBjYWZmZWluZSB0byByZWR1Y2UgZGFyayBjaXJjbGVzJyk7XG4gIH1cbiAgaWYgKHByb2JsZW1Db3VudHMucG9yZSA+IDApIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnUmVndWxhciBleGZvbGlhdGlvbiBoZWxwcyBtaW5pbWl6ZSBwb3JlIGFwcGVhcmFuY2UnKTtcbiAgfVxuICBpZiAocHJvYmxlbUNvdW50cy5kYXJrX3Nwb3QgPiAwKSB7XG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ1ZpdGFtaW4gQyBzZXJ1bSBjYW4gaGVscCBmYWRlIGRhcmsgc3BvdHMgYW5kIGV2ZW4gc2tpbiB0b25lJyk7XG4gIH1cbiAgaWYgKHByb2JsZW1Db3VudHMucmVkbmVzcyA+IDApIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnVXNlIHNvb3RoaW5nIHByb2R1Y3RzIHdpdGggbmlhY2luYW1pZGUgdG8gcmVkdWNlIHJlZG5lc3MnKTtcbiAgfVxuXG4gIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdBbHdheXMgdXNlIFNQRiAzMCsgc3Vuc2NyZWVuIGRhaWx5IGZvciBwcm90ZWN0aW9uJyk7XG5cbiAgcmV0dXJuIHJlY29tbWVuZGF0aW9ucztcbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJQT1NUIiwicmVxdWVzdCIsImJvZHkiLCJqc29uIiwiaW1hZ2UiLCJlcnJvciIsInN0YXR1cyIsImZvcm1EYXRhIiwiRm9ybURhdGEiLCJiYXNlNjREYXRhIiwicmVwbGFjZSIsImJpbmFyeURhdGEiLCJCdWZmZXIiLCJmcm9tIiwiYmxvYiIsIkJsb2IiLCJ0eXBlIiwiYXBwZW5kIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJwcm9jZXNzIiwiZW52IiwiQUlMQUJUT09MU19BUElfS0VZIiwib2siLCJlcnJvclRleHQiLCJ0ZXh0IiwiY29uc29sZSIsImRldGFpbHMiLCJkYXRhIiwidHJhbnNmb3JtZWRSZXN1bHQiLCJ0cmFuc2Zvcm1BSUxhYlJlc3BvbnNlIiwic3VjY2VzcyIsInJlc3VsdCIsIlN0cmluZyIsImFpTGFiRGF0YSIsImxvZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJwcm9ibGVtcyIsImRldGVjdGlvblRocmVzaG9sZCIsImFjbmUiLCJ2YWx1ZSIsImFjbmVTZXZlcml0eSIsIk1hdGgiLCJyb3VuZCIsImFjbmVDb3VudCIsImFjbmVMb2NhdGlvbnMiLCJ4IiwieSIsIndpZHRoIiwiaGVpZ2h0IiwiaSIsIm1pbiIsImxlbmd0aCIsInB1c2giLCJzZXZlcml0eSIsImxvY2F0aW9uIiwiY29uZmlkZW5jZSIsIndyaW5rbGUiLCJ3cmlua2xlU2V2ZXJpdHkiLCJ3cmlua2xlQ291bnQiLCJ3cmlua2xlTG9jYXRpb25zIiwiZGFya19jaXJjbGUiLCJjaXJjbGVTZXZlcml0eSIsImNpcmNsZUxvY2F0aW9ucyIsImZvckVhY2giLCJwb3JlIiwicG9yZVNldmVyaXR5IiwicG9yZUNvdW50IiwicG9yZUxvY2F0aW9ucyIsImRhcmtfc3BvdCIsInNwb3RTZXZlcml0eSIsInJlZG5lc3MiLCJyZWRuZXNzU2V2ZXJpdHkiLCJzeW50aGV0aWNQcm9ibGVtcyIsImZpbmQiLCJwIiwibWF4IiwiZmlsdGVyIiwic2xpY2UiLCJza2luVHlwZSIsInNraW5fdHlwZSIsInNraW5UeXBlVmFsdWUiLCJ0b0xvd2VyQ2FzZSIsIm92ZXJhbGxTY29yZSIsImNhbGN1bGF0ZU92ZXJhbGxTY29yZSIsInJlY29tbWVuZGF0aW9ucyIsImdlbmVyYXRlUmVjb21tZW5kYXRpb25zIiwidG90YWxEZWR1Y3Rpb24iLCJwcm9ibGVtIiwid2VpZ2h0IiwicHJvYmxlbUNvdW50cyIsInJlZHVjZSIsImFjYyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/skin-analysis/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fskin-analysis%2Froute&page=%2Fapi%2Fskin-analysis%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fskin-analysis%2Froute.ts&appDir=%2FUsers%2Fnicolasbrecqueville%2FDocuments%2FInformatique%2FEcole%2FEcole42%2FCursus%2Fedhec_project%2F42_X_EDHEC%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fnicolasbrecqueville%2FDocuments%2FInformatique%2FEcole%2FEcole42%2FCursus%2Fedhec_project%2F42_X_EDHEC&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();